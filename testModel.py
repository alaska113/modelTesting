import importlib
import torch
import torch.utils.data
import numpy as np
from preProcessing.main import *
import sys

def run():
    imagePath = sys.arv[1]
    data = PreProcessImages(imagePath)
    model = loadModel()
    model.cuda()
    test_loader = get_loader(data.eyes, data.poses, 1, 1, True)
    test(model, test_loader)


class MPIIGazeDataset(torch.utils.data.Dataset):
    def __init__(self, images, poses):
        self.images = images
        self.poses = poses
        self.length = len(self.images)
        self.images = torch.unsqueeze(torch.from_numpy(self.images), 1)
        self.poses = torch.from_numpy(self.poses)

    def __getitem__(self, index):
        return self.images[index], self.poses[index]

    def __len__(self):
        return self.length

    def __repr__(self):
        return self.__class__.__name__

def get_loader(images, poses, batch_size, num_workers, use_gpu):  
    test_dataset = MPIIGazeDataset(images, poses)

    test_loader = torch.utils.data.DataLoader(
        test_dataset,
        batch_size=batch_size,
        num_workers=num_workers,
        shuffle=False,
        pin_memory=use_gpu,
        drop_last=False,
    )
    return test_loader



def loadModel():
    # model
    module = importlib.import_module('models.{}'.format("lenet"))
    model = module.Model()
    return model

def imagesArr():
    images = [[[0.36966825, 0.37914693, 0.3507109 , 0.3649289 , 0.3744076 ,
                        0.3744076 , 0.3744076 , 0.3649289 , 0.36966825, 0.37914693,
                        0.3886256 , 0.3886256 , 0.39336494, 0.39336494, 0.39336494,
                        0.37914693, 0.35545024, 0.3270142 , 0.30805686, 0.3127962 ,
                        0.25592417, 0.24644549, 0.2748815 , 0.30331755, 0.33175355,
                        0.34597155, 0.33175355, 0.3507109 , 0.3649289 , 0.3886256 ,
                        0.40758294, 0.41232228, 0.41232228, 0.43127963, 0.45971563,
                        0.4549763 , 0.47393364, 0.49289098, 0.5165877 , 0.5450237 ,
                        0.55450237, 0.5687204 , 0.59241706, 0.60189575, 0.6445498 ,
                        0.66824645, 0.68720376, 0.6824645 , 0.6729858 , 0.69668245,
                        0.70616114, 0.7393365 , 0.75829387, 0.74407583, 0.7867299 ,
                        0.8151659 , 0.7914692 , 0.7914692 , 0.7819905 , 0.7819905 ],
                      [0.3744076 , 0.37914693, 0.35545024, 0.3744076 , 0.3744076 ,
                               0.36966825, 0.36966825, 0.36966825, 0.3744076 , 0.3886256 ,
                               0.39810428, 0.38388625, 0.38388625, 0.3744076 , 0.35545024,
                               0.3270142 , 0.29383886, 0.27014217, 0.25592417, 0.22274882,
                               0.16113745, 0.16113745, 0.22274882, 0.2606635 , 0.2890995 ,
                               0.3127962 , 0.31753555, 0.31753555, 0.33175355, 0.34597155,
                               0.3601896 , 0.36966825, 0.38388625, 0.41232228, 0.43601894,
                               0.42180094, 0.43127963, 0.44549763, 0.47393364, 0.50236964,
                               0.51184833, 0.521327  , 0.5450237 , 0.55450237, 0.5971564 ,
                               0.60189575, 0.6255924 , 0.6492891 , 0.6350711 , 0.63981044,
                               0.63981044, 0.7203792 , 0.7535545 , 0.73459715, 0.7772512 ,
                               0.79620856, 0.7677725 , 0.77251184, 0.7488152 , 0.75829387],
                      [0.38388625, 0.3886256 , 0.38388625, 0.3886256 , 0.37914693,
                               0.3744076 , 0.36966825, 0.36966825, 0.37914693, 0.3886256 ,
                               0.39336494, 0.3886256 , 0.3744076 , 0.3507109 , 0.3127962 ,
                               0.27014217, 0.24170616, 0.22274882, 0.21800947, 0.16113745,
                               0.13744076, 0.17061612, 0.2085308 , 0.1800948 , 0.17535545,
                               0.23222749, 0.2843602 , 0.26540285, 0.2748815 , 0.2890995 ,
                               0.3127962 , 0.33175355, 0.34597155, 0.3507109 , 0.34597155,
                               0.37914693, 0.3886256 , 0.39810428, 0.43127963, 0.46445498,
                               0.47393364, 0.48341233, 0.507109  , 0.51184833, 0.55450237,
                               0.5450237 , 0.5876777 , 0.63981044, 0.63033175, 0.6113744 ,
                               0.5971564 , 0.70616114, 0.7535545 , 0.7393365 , 0.7677725 ,
                               0.77251184, 0.7393365 , 0.75829387, 0.7393365 , 0.73459715],
                      [0.38388625, 0.39810428, 0.3886256 , 0.38388625, 0.3886256 ,
                               0.37914693, 0.3744076 , 0.37914693, 0.38388625, 0.38388625,
                               0.38388625, 0.3744076 , 0.3601896 , 0.30331755, 0.2748815 ,
                               0.24170616, 0.21800947, 0.2085308 , 0.14691943, 0.13270143,
                               0.14691943, 0.16587678, 0.16113745, 0.13270143, 0.13270143,
                               0.14691943, 0.1421801 , 0.10900474, 0.16587678, 0.20379147,
                               0.2085308 , 0.22748815, 0.2606635 , 0.27962086, 0.29383886,
                               0.2985782 , 0.29383886, 0.3364929 , 0.39336494, 0.4170616 ,
                               0.41232228, 0.43127963, 0.46445498, 0.47393364, 0.47393364,
                               0.507109  , 0.5308057 , 0.5592417 , 0.5592417 , 0.5592417 ,
                               0.60189575, 0.6729858 , 0.7156398 , 0.7298578 , 0.74407583,
                               0.7393365 , 0.7298578 , 0.73459715, 0.7298578 , 0.7298578 ],
                      [0.36966825, 0.37914693, 0.36966825, 0.37914693, 0.37914693,
                               0.38388625, 0.37914693, 0.37914693, 0.3886256 , 0.38388625,
                               0.3649289 , 0.3601896 , 0.31753555, 0.23222749, 0.1800948 ,
                               0.12322275, 0.09478673, 0.10900474, 0.0900474 , 0.12322275,
                               0.10900474, 0.1042654 , 0.08530806, 0.06635071, 0.08056872,
                               0.09952607, 0.09478673, 0.06161137, 0.10900474, 0.14691943,
                               0.16113745, 0.18483412, 0.20379147, 0.2085308 , 0.21327014,
                               0.27962086, 0.25592417, 0.2606635 , 0.3127962 , 0.35545024,
                               0.37914693, 0.3886256 , 0.4028436 , 0.42180094, 0.4265403 ,
                               0.45971563, 0.47867298, 0.507109  , 0.52606636, 0.5450237 ,
                               0.5971564 , 0.6350711 , 0.6824645 , 0.70616114, 0.7298578 ,
                               0.73459715, 0.72511846, 0.73459715, 0.72511846, 0.7014218 ],
                      [0.35545024, 0.3649289 , 0.3601896 , 0.3744076 , 0.3649289 ,
                               0.36966825, 0.3649289 , 0.3649289 , 0.3886256 , 0.38388625,
                               0.34123224, 0.27014217, 0.18957347, 0.10900474, 0.08530806,
                               0.08056872, 0.07109005, 0.0900474 , 0.08056872, 0.09952607,
                               0.0900474 , 0.08056872, 0.06161137, 0.0521327 , 0.06161137,
                               0.07582939, 0.07109005, 0.04739337, 0.06635071, 0.07582939,
                               0.0900474 , 0.1042654 , 0.09952607, 0.08530806, 0.08530806,
                               0.0900474 , 0.11374407, 0.16587678, 0.22748815, 0.27014217,
                               0.27962086, 0.27962086, 0.27962086, 0.34597155, 0.3601896 ,
                               0.3886256 , 0.39810428, 0.43127963, 0.47867298, 0.5165877 ,
                               0.57345974, 0.62085307, 0.66824645, 0.7014218 , 0.7298578 ,
                               0.7298578 , 0.7156398 , 0.7298578 , 0.7156398 , 0.6919431 ],
                      [0.35545024, 0.3744076 , 0.3744076 , 0.3744076 , 0.3601896 ,
                               0.3649289 , 0.3649289 , 0.3649289 , 0.3744076 , 0.34123224,
                               0.2606635 , 0.19905214, 0.13744076, 0.0900474 , 0.09478673,
                               0.1042654 , 0.09952607, 0.08530806, 0.06161137, 0.06635071,
                               0.07109005, 0.06635071, 0.0521327 , 0.03791469, 0.03791469,
                               0.04265403, 0.04265403, 0.06161137, 0.0521327 , 0.03791469,
                               0.04739337, 0.06161137, 0.05687204, 0.04265403, 0.0521327 ,
                               0.07109005, 0.08530806, 0.0900474 , 0.0900474 , 0.10900474,
                               0.14691943, 0.1943128 , 0.24170616, 0.26540285, 0.2843602 ,
                               0.30805686, 0.31753555, 0.3649289 , 0.43601894, 0.47867298,
                               0.5308057 , 0.5971564 , 0.6445498 , 0.6824645 , 0.7109005 ,
                               0.70616114, 0.7014218 , 0.72511846, 0.7109005 , 0.6919431 ],
                      [0.3649289 , 0.38388625, 0.39336494, 0.37914693, 0.3649289 ,
                               0.36966825, 0.3744076 , 0.36966825, 0.34123224, 0.2606635 ,
                               0.16113745, 0.16113745, 0.15165877, 0.15165877, 0.13744076,
                               0.1042654 , 0.08530806, 0.06635071, 0.0521327 , 0.06635071,
                               0.05687204, 0.04265403, 0.02843602, 0.03317536, 0.04265403,
                               0.03791469, 0.02843602, 0.02843602, 0.01421801, 0.        ,
                               0.01421801, 0.04265403, 0.04739337, 0.04265403, 0.06161137,
                               0.07109005, 0.0900474 , 0.08530806, 0.08530806, 0.11374407,
                               0.13744076, 0.15165877, 0.17535545, 0.19905214, 0.21800947,
                               0.24170616, 0.25592417, 0.31753555, 0.4028436 , 0.44549763,
                               0.48815167, 0.5450237 , 0.59241706, 0.6350711 , 0.6729858 ,
                               0.6729858 , 0.68720376, 0.73459715, 0.7298578 , 0.7298578 ],
                      [0.37914693, 0.38388625, 0.39336494, 0.38388625, 0.36966825,
                               0.3507109 , 0.34597155, 0.3364929 , 0.29383886, 0.21800947,
                               0.14691943, 0.1421801 , 0.13270143, 0.14691943, 0.12322275,
                               0.09952607, 0.09478673, 0.08530806, 0.08056872, 0.05687204,
                               0.05687204, 0.0521327 , 0.07109005, 0.11374407, 0.13270143,
                               0.1042654 , 0.07582939, 0.06161137, 0.06161137, 0.0521327 ,
                               0.05687204, 0.06635071, 0.04739337, 0.03317536, 0.03791469,
                               0.05687204, 0.08056872, 0.07582939, 0.06635071, 0.08056872,
                               0.0900474 , 0.11374407, 0.14691943, 0.1563981 , 0.17061612,
                               0.19905214, 0.21327014, 0.2748815 , 0.35545024, 0.4028436 ,
                               0.45023698, 0.507109  , 0.55450237, 0.6066351 , 0.6492891 ,
                               0.65876776, 0.68720376, 0.7535545 , 0.75829387, 0.76303315],
                      [0.3886256 , 0.38388625, 0.38388625, 0.38388625, 0.37914693,
                               0.34597155, 0.3222749 , 0.30331755, 0.24644549, 0.18483412,
                               0.17061612, 0.16587678, 0.12322275, 0.12796208, 0.12796208,
                               0.12322275, 0.13270143, 0.11848341, 0.12796208, 0.09478673,
                               0.12322275, 0.14691943, 0.18483412, 0.24170616, 0.25592417,
                               0.23222749, 0.2085308 , 0.23696682, 0.24170616, 0.22748815,
                               0.2085308 , 0.17535545, 0.12796208, 0.0900474 , 0.08056872,
                               0.07109005, 0.09478673, 0.08056872, 0.06161137, 0.06161137,
                               0.0521327 , 0.05687204, 0.09952607, 0.15165877, 0.16587678,
                               0.18957347, 0.1943128 , 0.23222749, 0.29383886, 0.34123224,
                               0.4028436 , 0.46919432, 0.5165877 , 0.5829384 , 0.63981044,
                               0.6540284 , 0.69668245, 0.7772512 , 0.7867299 , 0.7819905 ],
                      [0.4028436 , 0.38388625, 0.3744076 , 0.3744076 , 0.39810428,
                               0.3744076 , 0.34123224, 0.30331755, 0.2085308 , 0.13744076,
                               0.1421801 , 0.1563981 , 0.12322275, 0.1563981 , 0.17061612,
                               0.16113745, 0.1563981 , 0.16113745, 0.20379147, 0.21800947,
                               0.2606635 , 0.29383886, 0.31753555, 0.3507109 , 0.3649289 ,
                               0.3601896 , 0.36966825, 0.3601896 , 0.3744076 , 0.3601896 ,
                               0.3222749 , 0.27962086, 0.21800947, 0.17535545, 0.16587678,
                               0.11848341, 0.11374407, 0.08056872, 0.08056872, 0.11374407,
                               0.10900474, 0.09478673, 0.11374407, 0.16587678, 0.1800948 ,
                               0.19905214, 0.18957347, 0.19905214, 0.24170616, 0.2890995 ,
                               0.3649289 , 0.41232228, 0.46919432, 0.549763  , 0.62085307,
                               0.6492891 , 0.70616114, 0.79620856, 0.81042653, 0.82464457],
                      [0.38388625, 0.37914693, 0.39336494, 0.39810428, 0.38388625,
                               0.3744076 , 0.34597155, 0.2890995 , 0.23696682, 0.19905214,
                               0.16587678, 0.17061612, 0.16587678, 0.17535545, 0.18957347,
                               0.19905214, 0.21327014, 0.23696682, 0.26540285, 0.2890995 ,
                               0.31753555, 0.35545024, 0.39336494, 0.4170616 , 0.3507109 ,
                               0.39810428, 0.4170616 , 0.3744076 , 0.31753555, 0.3222749 ,
                               0.31753555, 0.25118482, 0.2085308 , 0.21327014, 0.19905214,
                               0.14691943, 0.12322275, 0.14691943, 0.15165877, 0.15165877,
                               0.12796208, 0.1943128 , 0.1800948 , 0.1800948 , 0.1943128 ,
                               0.18483412, 0.18957347, 0.2085308 , 0.21800947, 0.25118482,
                               0.3270142 , 0.3886256 , 0.41232228, 0.48341233, 0.549763  ,
                               0.62085307, 0.7109005 , 0.7867299 , 0.8293839 , 0.8815166 ],
                      [0.39336494, 0.39336494, 0.39810428, 0.39336494, 0.37914693,
                               0.36966825, 0.34123224, 0.29383886, 0.26540285, 0.24170616,
                               0.21800947, 0.21327014, 0.20379147, 0.20379147, 0.21327014,
                               0.22748815, 0.24644549, 0.2890995 , 0.3222749 , 0.3222749 ,
                               0.35545024, 0.41232228, 0.40758294, 0.39336494, 0.34597155,
                               0.3507109 , 0.30805686, 0.27962086, 0.2890995 , 0.25592417,
                               0.22274882, 0.24644549, 0.22748815, 0.17535545, 0.18957347,
                               0.14691943, 0.12322275, 0.12322275, 0.10900474, 0.11374407,
                               0.12322275, 0.19905214, 0.18483412, 0.17535545, 0.18483412,
                               0.18483412, 0.20379147, 0.24170616, 0.24644549, 0.25118482,
                               0.2890995 , 0.33175355, 0.39810428, 0.4549763 , 0.52606636,
                               0.6350711 , 0.7203792 , 0.7819905 , 0.8578199 , 0.9336493 ],
                      [0.3886256 , 0.37914693, 0.37914693, 0.4028436 , 0.38388625,
                               0.35545024, 0.3127962 , 0.2748815 , 0.27014217, 0.27014217,
                               0.2606635 , 0.24644549, 0.24170616, 0.24170616, 0.25118482,
                               0.26540285, 0.2890995 , 0.3222749 , 0.3507109 , 0.34597155,
                               0.34597155, 0.38388625, 0.3270142 , 0.25118482, 0.21327014,
                               0.19905214, 0.14691943, 0.14691943, 0.13744076, 0.13744076,
                               0.12796208, 0.16113745, 0.18483412, 0.16587678, 0.18957347,
                               0.1421801 , 0.13744076, 0.12322275, 0.08530806, 0.07109005,
                               0.08056872, 0.14691943, 0.13744076, 0.1563981 , 0.17535545,
                               0.18483412, 0.21800947, 0.25592417, 0.25592417, 0.24644549,
                               0.27014217, 0.3270142 , 0.3886256 , 0.43127963, 0.50236964,
                               0.6161137 , 0.7014218 , 0.7867299 , 0.8720379 , 0.95734596],
                      [0.39810428, 0.39336494, 0.39810428, 0.39336494, 0.37914693,
                               0.3601896 , 0.3222749 , 0.2843602 , 0.2843602 , 0.2890995 ,
                               0.27014217, 0.25118482, 0.2606635 , 0.27962086, 0.29383886,
                               0.2985782 , 0.30331755, 0.30331755, 0.30805686, 0.34597155,
                               0.25592417, 0.2085308 , 0.13744076, 0.10900474, 0.11848341,
                               0.1042654 , 0.0900474 , 0.09952607, 0.0521327 , 0.07109005,
                               0.06635071, 0.03791469, 0.04739337, 0.07109005, 0.1042654 ,
                               0.10900474, 0.12322275, 0.11374407, 0.08530806, 0.05687204,
                               0.0521327 , 0.09952607, 0.1042654 , 0.14691943, 0.17061612,
                               0.1943128 , 0.22748815, 0.25592417, 0.2606635 , 0.27014217,
                               0.30331755, 0.31753555, 0.34597155, 0.4028436 , 0.50236964,
                               0.60189575, 0.7109005 , 0.83886254, 0.8957346 , 0.93838865],
                      [0.4028436 , 0.39810428, 0.4028436 , 0.36966825, 0.3744076 ,
                               0.37914693, 0.3601896 , 0.33175355, 0.31753555, 0.30331755,
                               0.27962086, 0.2606635 , 0.27962086, 0.30331755, 0.3127962 ,
                               0.30331755, 0.27962086, 0.25118482, 0.23222749, 0.15165877,
                               0.13744076, 0.12322275, 0.0900474 , 0.09478673, 0.09952607,
                               0.04739337, 0.0521327 , 0.0900474 , 0.10900474, 0.11374407,
                               0.09952607, 0.08056872, 0.07109005, 0.08056872, 0.09478673,
                               0.12322275, 0.12322275, 0.0900474 , 0.0900474 , 0.07582939,
                               0.06635071, 0.09478673, 0.12322275, 0.13744076, 0.16587678,
                               0.1943128 , 0.22748815, 0.2606635 , 0.27962086, 0.30331755,
                               0.3364929 , 0.3270142 , 0.34597155, 0.39336494, 0.507109  ,
                               0.6161137 , 0.72511846, 0.8483412 , 0.8957346 , 0.9526066 ],
                      [0.39810428, 0.3886256 , 0.39810428, 0.3886256 , 0.37914693,
                               0.3744076 , 0.3649289 , 0.33175355, 0.3127962 , 0.30331755,
                               0.2890995 , 0.2843602 , 0.2985782 , 0.30805686, 0.2985782 ,
                               0.2748815 , 0.24170616, 0.20379147, 0.17535545, 0.14691943,
                               0.16587678, 0.11374407, 0.06161137, 0.07582939, 0.11374407,
                               0.07109005, 0.07582939, 0.14691943, 0.16113745, 0.11848341,
                               0.08530806, 0.09478673, 0.21800947, 0.3364929 , 0.27962086,
                               0.24644549, 0.2085308 , 0.11848341, 0.1042654 , 0.09952607,
                               0.09478673, 0.09478673, 0.11374407, 0.11374407, 0.13744076,
                               0.17061612, 0.2085308 , 0.25118482, 0.2843602 , 0.30805686,
                               0.3270142 , 0.3601896 , 0.39810428, 0.3886256 , 0.47393364,
                               0.6113744 , 0.70616114, 0.8293839 , 0.91943127, 0.99526066],
                      [0.40758294, 0.4028436 , 0.42180094, 0.41232228, 0.38388625,
                               0.3649289 , 0.35545024, 0.31753555, 0.2985782 , 0.2985782 ,
                               0.2985782 , 0.29383886, 0.30331755, 0.29383886, 0.27014217,
                               0.24170616, 0.2085308 , 0.17061612, 0.13744076, 0.11848341,
                               0.11848341, 0.07109005, 0.12796208, 0.21800947, 0.29383886,
                               0.24644549, 0.1800948 , 0.2606635 , 0.23696682, 0.09952607,
                               0.02369668, 0.03317536, 0.23696682, 0.4549763 , 0.3649289 ,
                               0.34123224, 0.3127962 , 0.1943128 , 0.15165877, 0.12322275,
                               0.10900474, 0.08056872, 0.0900474 , 0.09952607, 0.11848341,
                               0.1563981 , 0.1943128 , 0.22748815, 0.26540285, 0.30331755,
                               0.3222749 , 0.3507109 , 0.39810428, 0.38388625, 0.47393364,
                               0.60189575, 0.69668245, 0.8436019 , 0.9478673 , 1.        ],
                      [0.39810428, 0.39810428, 0.41232228, 0.39810428, 0.36966825,
                               0.36966825, 0.37914693, 0.3507109 , 0.31753555, 0.30805686,
                               0.3127962 , 0.29383886, 0.29383886, 0.2843602 , 0.25592417,
                               0.22274882, 0.18957347, 0.15165877, 0.11848341, 0.0900474 ,
                               0.11374407, 0.11848341, 0.23222749, 0.2748815 , 0.2985782 ,
                               0.27014217, 0.22274882, 0.2748815 , 0.3364929 , 0.16587678,
                               0.0900474 , 0.13270143, 0.22748815, 0.34597155, 0.2606635 ,
                               0.3270142 , 0.34597155, 0.24644549, 0.19905214, 0.15165877,
                               0.13270143, 0.09478673, 0.09952607, 0.1042654 , 0.13744076,
                               0.1800948 , 0.19905214, 0.21327014, 0.25118482, 0.30805686,
                               0.3507109 , 0.34123224, 0.37914693, 0.4170616 , 0.52606636,
                               0.60189575, 0.6824645 , 0.8341232 , 0.90047395, 0.971564  ],
                      [0.39810428, 0.40758294, 0.39810428, 0.38388625, 0.38388625,
                               0.38388625, 0.36966825, 0.3601896 , 0.34597155, 0.33175355,
                               0.31753555, 0.30331755, 0.29383886, 0.27014217, 0.25592417,
                               0.24644549, 0.21800947, 0.1563981 , 0.09478673, 0.12322275,
                               0.13744076, 0.1800948 , 0.2985782 , 0.35545024, 0.34597155,
                               0.3127962 , 0.1800948 , 0.2606635 , 0.3127962 , 0.2843602 ,
                               0.20379147, 0.24644549, 0.23696682, 0.16113745, 0.25118482,
                               0.39810428, 0.3127962 , 0.24170616, 0.22274882, 0.2085308 ,
                               0.17535545, 0.1563981 , 0.15165877, 0.15165877, 0.16587678,
                               0.20379147, 0.22748815, 0.22274882, 0.24644549, 0.30331755,
                               0.3364929 , 0.3649289 , 0.38388625, 0.4407583 , 0.507109  ,
                               0.62085307, 0.6824645 , 0.82464457, 0.8957346 , 0.95734596],
                      [0.4028436 , 0.40758294, 0.4028436 , 0.4028436 , 0.39336494,
                               0.38388625, 0.37914693, 0.3744076 , 0.3649289 , 0.3601896 ,
                               0.35545024, 0.3222749 , 0.30331755, 0.2748815 , 0.25118482,
                               0.22748815, 0.19905214, 0.15165877, 0.11374407, 0.14691943,
                               0.17535545, 0.2085308 , 0.30805686, 0.3744076 , 0.3886256 ,
                               0.36966825, 0.25592417, 0.1800948 , 0.23696682, 0.2748815 ,
                               0.24170616, 0.23222749, 0.18957347, 0.18483412, 0.34597155,
                               0.43601894, 0.31753555, 0.23696682, 0.2085308 , 0.17061612,
                               0.16113745, 0.16587678, 0.14691943, 0.1563981 , 0.16587678,
                               0.20379147, 0.23222749, 0.23222749, 0.25592417, 0.30805686,
                               0.3507109 , 0.36966825, 0.39336494, 0.4265403 , 0.5308057 ,
                               0.62085307, 0.68720376, 0.7819905 , 0.87677723, 0.95734596],
                      [0.4028436 , 0.41232228, 0.40758294, 0.4028436 , 0.38388625,
                               0.3744076 , 0.37914693, 0.38388625, 0.36966825, 0.35545024,
                               0.35545024, 0.33175355, 0.30805686, 0.27962086, 0.2606635 ,
                               0.24170616, 0.21800947, 0.19905214, 0.18957347, 0.19905214,
                               0.21800947, 0.19905214, 0.23696682, 0.2985782 , 0.34597155,
                               0.3649289 , 0.30331755, 0.21327014, 0.1943128 , 0.20379147,
                               0.1943128 , 0.19905214, 0.22748815, 0.30805686, 0.46919432,
                               0.40758294, 0.27962086, 0.19905214, 0.16587678, 0.11848341,
                               0.12796208, 0.14691943, 0.11848341, 0.15165877, 0.16113745,
                               0.20379147, 0.24170616, 0.24644549, 0.2606635 , 0.30331755,
                               0.34597155, 0.3649289 , 0.4028436 , 0.40758294, 0.5450237 ,
                               0.62085307, 0.68720376, 0.74407583, 0.8530806 , 0.9620853 ],
                      [0.40758294, 0.4170616 , 0.41232228, 0.41232228, 0.38388625,
                               0.37914693, 0.39336494, 0.39336494, 0.3601896 , 0.3364929 ,
                               0.3270142 , 0.3364929 , 0.30331755, 0.2748815 , 0.2748815 ,
                               0.27014217, 0.25592417, 0.25592417, 0.26540285, 0.25118482,
                               0.24644549, 0.1800948 , 0.17061612, 0.21800947, 0.26540285,
                               0.30331755, 0.2985782 , 0.30805686, 0.23696682, 0.21800947,
                               0.20379147, 0.22748815, 0.2985782 , 0.34123224, 0.36966825,
                               0.2843602 , 0.20379147, 0.1563981 , 0.1421801 , 0.12322275,
                               0.1421801 , 0.16587678, 0.1563981 , 0.1563981 , 0.17535545,
                               0.21800947, 0.26540285, 0.2748815 , 0.2748815 , 0.30331755,
                               0.34123224, 0.36966825, 0.4170616 , 0.42180094, 0.53554505,
                               0.63981044, 0.7014218 , 0.76303315, 0.86255926, 0.971564  ],
                      [0.41232228, 0.42180094, 0.4170616 , 0.43127963, 0.40758294,
                               0.39336494, 0.40758294, 0.4028436 , 0.3744076 , 0.34597155,
                               0.3364929 , 0.3507109 , 0.30805686, 0.2843602 , 0.2890995 ,
                               0.29383886, 0.27962086, 0.2748815 , 0.2843602 , 0.2843602 ,
                               0.27014217, 0.21327014, 0.20379147, 0.23696682, 0.24170616,
                               0.25592417, 0.27014217, 0.30331755, 0.2606635 , 0.26540285,
                               0.2606635 , 0.25118482, 0.2890995 , 0.2843602 , 0.22748815,
                               0.25118482, 0.23222749, 0.1943128 , 0.16587678, 0.1563981 ,
                               0.1563981 , 0.16113745, 0.17535545, 0.1943128 , 0.2085308 ,
                               0.24170616, 0.2748815 , 0.2843602 , 0.2890995 , 0.3127962 ,
                               0.3507109 , 0.37914693, 0.4265403 , 0.4549763 , 0.521327  ,
                               0.6635071 , 0.7203792 , 0.8151659 , 0.89099526, 0.98578197],
                      [0.41232228, 0.42180094, 0.4170616 , 0.43601894, 0.41232228,
                               0.39810428, 0.39810428, 0.39810428, 0.37914693, 0.36966825,
                               0.36966825, 0.3649289 , 0.33175355, 0.30805686, 0.31753555,
                               0.3270142 , 0.31753555, 0.30805686, 0.3127962 , 0.3222749 ,
                               0.2985782 , 0.2606635 , 0.25592417, 0.26540285, 0.24170616,
                               0.22748815, 0.23696682, 0.24170616, 0.21800947, 0.24170616,
                               0.2606635 , 0.24644549, 0.25118482, 0.24170616, 0.20379147,
                               0.1943128 , 0.21327014, 0.18957347, 0.16113745, 0.17061612,
                               0.17535545, 0.18957347, 0.22274882, 0.22748815, 0.23696682,
                               0.24644549, 0.25592417, 0.27014217, 0.2843602 , 0.3127962 ,
                               0.3507109 , 0.37914693, 0.42180094, 0.46445498, 0.507109  ,
                               0.6540284 , 0.7109005 , 0.8293839 , 0.89099526, 0.97630334],
                      [0.4170616 , 0.42180094, 0.4170616 , 0.4170616 , 0.4028436 ,
                               0.39336494, 0.3886256 , 0.3886256 , 0.38388625, 0.37914693,
                               0.37914693, 0.3649289 , 0.34597155, 0.3364929 , 0.34597155,
                               0.3507109 , 0.34597155, 0.34597155, 0.3507109 , 0.34597155,
                               0.3222749 , 0.2985782 , 0.27962086, 0.27962086, 0.27014217,
                               0.24644549, 0.24170616, 0.23696682, 0.22748815, 0.24170616,
                               0.2748815 , 0.2748815 , 0.25592417, 0.23222749, 0.20379147,
                               0.2085308 , 0.21327014, 0.19905214, 0.17061612, 0.16113745,
                               0.17061612, 0.18957347, 0.2085308 , 0.24170616, 0.2606635 ,
                               0.26540285, 0.2606635 , 0.2748815 , 0.2985782 , 0.3222749 ,
                               0.34597155, 0.3886256 , 0.42180094, 0.4549763 , 0.521327  ,
                               0.62085307, 0.6919431 , 0.80094784, 0.8720379 , 0.9336493 ],
                      [0.4170616 , 0.42180094, 0.4170616 , 0.4028436 , 0.40758294,
                               0.4028436 , 0.39810428, 0.39336494, 0.3886256 , 0.38388625,
                               0.37914693, 0.3601896 , 0.35545024, 0.3507109 , 0.3507109 ,
                               0.34597155, 0.34123224, 0.3507109 , 0.3601896 , 0.34597155,
                               0.3364929 , 0.33175355, 0.31753555, 0.3222749 , 0.3270142 ,
                               0.30805686, 0.2843602 , 0.2748815 , 0.27962086, 0.2748815 ,
                               0.2748815 , 0.27962086, 0.2748815 , 0.27014217, 0.26540285,
                               0.23696682, 0.23222749, 0.22748815, 0.20379147, 0.1800948 ,
                               0.19905214, 0.22274882, 0.21327014, 0.25118482, 0.2890995 ,
                               0.2985782 , 0.2890995 , 0.30805686, 0.3270142 , 0.3364929 ,
                               0.3507109 , 0.41232228, 0.4407583 , 0.4549763 , 0.56398106,
                               0.6066351 , 0.6919431 , 0.7819905 , 0.8672986 , 0.8862559 ],
                      [0.4170616 , 0.43127963, 0.4028436 , 0.39810428, 0.39336494,
                               0.39336494, 0.39810428, 0.4028436 , 0.39810428, 0.38388625,
                               0.3744076 , 0.36966825, 0.35545024, 0.34597155, 0.3507109 ,
                               0.36966825, 0.37914693, 0.3744076 , 0.3649289 , 0.3507109 ,
                               0.35545024, 0.3507109 , 0.3364929 , 0.3270142 , 0.33175355,
                               0.3270142 , 0.3222749 , 0.2985782 , 0.30331755, 0.3127962 ,
                               0.3222749 , 0.30805686, 0.2843602 , 0.26540285, 0.2606635 ,
                               0.24170616, 0.21800947, 0.21327014, 0.20379147, 0.1800948 ,
                               0.18957347, 0.22274882, 0.24170616, 0.26540285, 0.2843602 ,
                               0.30331755, 0.3127962 , 0.31753555, 0.3270142 , 0.3507109 ,
                               0.3744076 , 0.4170616 , 0.43601894, 0.43601894, 0.549763  ,
                               0.63033175, 0.70616114, 0.7819905 , 0.8436019 , 0.8862559 ],
                      [0.40758294, 0.43127963, 0.40758294, 0.39810428, 0.39810428,
                               0.39810428, 0.4028436 , 0.40758294, 0.4028436 , 0.39336494,
                               0.38388625, 0.37914693, 0.36966825, 0.3601896 , 0.3649289 ,
                               0.3744076 , 0.38388625, 0.37914693, 0.3744076 , 0.35545024,
                               0.3601896 , 0.3601896 , 0.34597155, 0.34123224, 0.34123224,
                               0.3364929 , 0.33175355, 0.3270142 , 0.3222749 , 0.3270142 ,
                               0.3270142 , 0.3127962 , 0.2890995 , 0.2748815 , 0.2748815 ,
                               0.24644549, 0.22274882, 0.21800947, 0.21800947, 0.2085308 ,
                               0.21800947, 0.25118482, 0.26540285, 0.27014217, 0.2890995 ,
                               0.3127962 , 0.3270142 , 0.3364929 , 0.34597155, 0.3601896 ,
                               0.3744076 , 0.39810428, 0.42180094, 0.43601894, 0.549763  ,
                               0.63033175, 0.70616114, 0.7819905 , 0.8436019 , 0.90047395],
                      [0.4028436 , 0.4265403 , 0.41232228, 0.4028436 , 0.4028436 ,
                               0.4028436 , 0.40758294, 0.41232228, 0.40758294, 0.4028436 ,
                               0.39336494, 0.3886256 , 0.38388625, 0.37914693, 0.37914693,
                               0.38388625, 0.3886256 , 0.3886256 , 0.3886256 , 0.36966825,
                               0.3744076 , 0.3744076 , 0.3649289 , 0.3649289 , 0.3649289 ,
                               0.3601896 , 0.3507109 , 0.3601896 , 0.3507109 , 0.34123224,
                               0.33175355, 0.3127962 , 0.29383886, 0.2843602 , 0.2890995 ,
                               0.2606635 , 0.24170616, 0.23696682, 0.24170616, 0.24170616,
                               0.25592417, 0.27962086, 0.29383886, 0.2890995 , 0.30805686,
                               0.33175355, 0.34597155, 0.35545024, 0.3601896 , 0.3649289 ,
                               0.36966825, 0.39810428, 0.4265403 , 0.45023698, 0.55450237,
                               0.6255924 , 0.7014218 , 0.76303315, 0.8293839 , 0.9146919 ],
                      [0.4028436 , 0.42180094, 0.41232228, 0.40758294, 0.40758294,
                               0.4028436 , 0.40758294, 0.40758294, 0.40758294, 0.39810428,
                               0.39336494, 0.3886256 , 0.39336494, 0.39336494, 0.3886256 ,
                               0.38388625, 0.38388625, 0.3886256 , 0.39336494, 0.38388625,
                               0.3886256 , 0.39336494, 0.3886256 , 0.3886256 , 0.3886256 ,
                               0.38388625, 0.3744076 , 0.37914693, 0.36966825, 0.35545024,
                               0.34123224, 0.3222749 , 0.2985782 , 0.2890995 , 0.29383886,
                               0.2748815 , 0.25592417, 0.25118482, 0.25592417, 0.27014217,
                               0.27962086, 0.29383886, 0.30331755, 0.3270142 , 0.3364929 ,
                               0.34597155, 0.35545024, 0.3649289 , 0.3649289 , 0.3649289 ,
                               0.3601896 , 0.39336494, 0.4265403 , 0.45971563, 0.55450237,
                               0.6255924 , 0.7014218 , 0.75829387, 0.8293839 , 0.9241706 ],
                      [0.40758294, 0.42180094, 0.40758294, 0.40758294, 0.40758294,
                               0.40758294, 0.40758294, 0.4028436 , 0.4028436 , 0.39810428,
                               0.39336494, 0.38388625, 0.39336494, 0.39810428, 0.39336494,
                               0.3886256 , 0.38388625, 0.39336494, 0.39810428, 0.39810428,
                               0.4028436 , 0.4028436 , 0.4028436 , 0.40758294, 0.40758294,
                               0.4028436 , 0.3886256 , 0.38388625, 0.36966825, 0.3601896 ,
                               0.3507109 , 0.3270142 , 0.30331755, 0.2890995 , 0.2890995 ,
                               0.27962086, 0.26540285, 0.2606635 , 0.27014217, 0.2890995 ,
                               0.2985782 , 0.30805686, 0.31753555, 0.3507109 , 0.3507109 ,
                               0.3507109 , 0.35545024, 0.3601896 , 0.3649289 , 0.36966825,
                               0.36966825, 0.38388625, 0.4170616 , 0.4549763 , 0.549763  ,
                               0.6255924 , 0.7156398 , 0.7772512 , 0.8530806 , 0.943128  ],
                      [0.40758294, 0.4170616 , 0.4028436 , 0.41232228, 0.41232228,
                               0.40758294, 0.40758294, 0.4028436 , 0.4028436 , 0.39810428,
                               0.39810428, 0.3886256 , 0.39336494, 0.4028436 , 0.39810428,
                               0.39336494, 0.39336494, 0.4028436 , 0.40758294, 0.41232228,
                               0.41232228, 0.41232228, 0.40758294, 0.40758294, 0.41232228,
                               0.40758294, 0.39336494, 0.3744076 , 0.3649289 , 0.3601896 ,
                               0.3507109 , 0.33175355, 0.30805686, 0.29383886, 0.29383886,
                               0.2748815 , 0.2748815 , 0.2748815 , 0.2890995 , 0.3127962 ,
                               0.3222749 , 0.3270142 , 0.34123224, 0.35545024, 0.3507109 ,
                               0.3507109 , 0.3507109 , 0.3601896 , 0.36966825, 0.37914693,
                               0.3886256 , 0.39810428, 0.42180094, 0.45971563, 0.54028434,
                               0.6161137 , 0.72511846, 0.7819905 , 0.8578199 , 0.96682465],
                      [0.4028436 , 0.41232228, 0.4028436 , 0.41232228, 0.41232228,
                               0.41232228, 0.41232228, 0.41232228, 0.41232228, 0.41232228,
                               0.41232228, 0.4028436 , 0.40758294, 0.41232228, 0.41232228,
                               0.41232228, 0.41232228, 0.4170616 , 0.42180094, 0.42180094,
                               0.42180094, 0.41232228, 0.4028436 , 0.4028436 , 0.40758294,
                               0.39810428, 0.38388625, 0.36966825, 0.3601896 , 0.3507109 ,
                               0.34597155, 0.3270142 , 0.30805686, 0.2985782 , 0.30331755,
                               0.2890995 , 0.29383886, 0.2985782 , 0.3127962 , 0.3364929 ,
                               0.3364929 , 0.34123224, 0.3601896 , 0.35545024, 0.35545024,
                               0.3601896 , 0.3601896 , 0.3601896 , 0.36966825, 0.38388625,
                               0.39810428, 0.4265403 , 0.43127963, 0.45971563, 0.52606636,
                               0.6066351 , 0.7203792 , 0.7772512 , 0.8530806 , 0.9810427 ],
                      [0.39810428, 0.40758294, 0.40758294, 0.4170616 , 0.4170616 ,
                               0.4170616 , 0.4170616 , 0.42180094, 0.42180094, 0.4265403 ,
                               0.4265403 , 0.41232228, 0.4170616 , 0.42180094, 0.42180094,
                               0.4265403 , 0.43127963, 0.43601894, 0.43601894, 0.43127963,
                               0.4265403 , 0.41232228, 0.39810428, 0.39336494, 0.39336494,
                               0.38388625, 0.36966825, 0.36966825, 0.35545024, 0.34597155,
                               0.3364929 , 0.3222749 , 0.30805686, 0.30805686, 0.3127962 ,
                               0.30805686, 0.31753555, 0.3222749 , 0.33175355, 0.3507109 ,
                               0.34597155, 0.34123224, 0.3649289 , 0.3601896 , 0.3649289 ,
                               0.36966825, 0.3649289 , 0.3649289 , 0.36966825, 0.37914693,
                               0.39336494, 0.4265403 , 0.4265403 , 0.45023698, 0.51184833,
                               0.5971564 , 0.72511846, 0.7819905 , 0.86255926, 0.97630334],
                      [0.39336494, 0.39336494, 0.39336494, 0.4028436 , 0.39810428,
                               0.39810428, 0.40758294, 0.4170616 , 0.4265403 , 0.43601894,
                               0.4407583 , 0.4265403 , 0.4265403 , 0.43127963, 0.43127963,
                               0.43601894, 0.43601894, 0.43127963, 0.4265403 , 0.43601894,
                               0.4265403 , 0.4170616 , 0.40758294, 0.39810428, 0.39336494,
                               0.38388625, 0.37914693, 0.36966825, 0.35545024, 0.3507109 ,
                               0.34123224, 0.33175355, 0.33175355, 0.3364929 , 0.33175355,
                               0.3270142 , 0.33175355, 0.33175355, 0.34597155, 0.35545024,
                               0.34597155, 0.3364929 , 0.35545024, 0.35545024, 0.3744076 ,
                               0.38388625, 0.3744076 , 0.3649289 , 0.3744076 , 0.3886256 ,
                               0.39336494, 0.4265403 , 0.4170616 , 0.4028436 , 0.49289098,
                               0.6161137 , 0.7109005 , 0.81042653, 0.8341232 , 0.91943127]]]
    images = np.array(images)
    return images


def test(model, test_loader):
    model.eval()
    
    for step, (images, poses) in enumerate(test_loader):
        images = images.float()
        poses = poses.float()
        images = images.cuda()
        poses = poses.cuda()

        with torch.no_grad():
            outputs = model(images, poses)

        print(outputs)

def posesArr():
    poses = np.array([[-0.004605413803330658,1.7516345710193977]])
    return poses



if __name__ == "__main__":
    run()



   
   
                   
